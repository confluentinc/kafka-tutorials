kind: kstreams
steps:
  - name: initialize
    action: execute
    file: recipe-steps/dev/init.sh

  - name: make the build file
    change_directory: filter-events
    action: make_file
    file: build.gradle

  - name: make the configuration directory
    action: execute
    file: recipe-steps/dev/make-configuration-dir.sh

  - name: make the dev props file
    action: make_file
    file: configuration/dev.properties

  - name: make a directory for Avro files
    action: execute
    file: recipe-steps/dev/make-avro-dir.sh

  - name: make Avro schema
    action: make_file
    file: src/main/avro/publication.avsc

  - name: build the project
    action: execute
    file: recipe-steps/dev/build-project.sh

  - name: make the source directory
    action: execute
    file: recipe-steps/dev/make-src-dir.sh

  - name: make the main Java file
    action: make_file
    file: src/main/java/io/confluent/developer/FilterEvents.java

  - name: make an uberjar
    action: execute
    file: recipe-steps/dev/build-uberjar.sh

  - name: run the jar
    action: execute_async
    as: dev_jar
    file: recipe-steps/dev/run-dev-app.sh

  - name: run the producer
    action: execute
    file: recipe-steps/dev/console-producer.sh
    stdin: recipe-steps/dev/input-events.json

  - name: run the consumer
    action: execute
    file: recipe-steps/dev/console-consumer.sh
    append: --timeout 3000
    stdout: recipe-steps/dev/outputs/actual-console-output.log

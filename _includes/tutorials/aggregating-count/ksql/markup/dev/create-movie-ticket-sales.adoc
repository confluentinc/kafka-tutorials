This tutorial takes a stream of individual movie ticket sales events and counts the total number of tickets sold per movie. Not all ticket prices are the same (apparently some of these theaters are fancier than others), but the task of the KSQL query is just to group and count regardless of ticket price.

This line of KSQL DDL creates a stream and its underlying Kafka topic to represent the annual sales totals. If the topic already exists, then KSQL simply registers is as the source of data underlying the new stream. The stream has three fields: `title`, the name of the movie; `sale_ts`, the time at which the ticket was sold; and `ticket_total_value`, the price paid for the ticket.

The statement specifies several other things. It names the underlying Kafka topic as `movie-ticket-sales`, specifies that it should have a single partition, and defines Avro as its data format. It also specifies that the `sale_ts` field contains the event time of each message in standard ISO-8601 format. Every message in a KSQL stream has a timestamp, which by default is just the time on the broker at the moment at which it was originally produced to its underlying topic. But sometimes events know their own event time, as they do in this example, so we want KSQL to use that time instead.

+++++
<pre class="snippet"><code class="sql">{% include_raw tutorials/aggregating-count/ksql/code/tutorial-steps/dev/create-movie-ticket-sales.sql %}</code></pre>
+++++
